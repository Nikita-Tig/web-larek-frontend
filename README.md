# Проектная работа "Веб-ларек"

Стек: HTML, SCSS, TS, Webpack

Структура проекта:
- src/ — исходные файлы проекта
- src/components/ — папка с JS компонентами
- src/components/base/ — папка с базовым кодом

Важные файлы:
- src/pages/index.html — HTML-файл главной страницы
- src/types/index.ts — файл с типами
- src/index.ts — точка входа приложения
- src/scss/styles.scss — корневой файл стилей
- src/utils/constants.ts — файл с константами
- src/utils/utils.ts — файл с утилитами

## Установка и запуск
Для установки и запуска проекта необходимо выполнить команды

```
npm install
npm run start
```

или

```
yarn
yarn start
```
## Сборка

```
npm run build
```

или

```
yarn build
```

# Архитектура 
Архитектура проекта разрабатывается с использованием MVP паттерна, в котором основными слоями являются:
M –– это модели с данными, отвечают за работу с данными.
V –– это компоненты представления, отвечают за отображение данных на экране.
P –– это презентер, он не будет выделен в отдельный класс а будет содержатся в основном коде файла index.ts.

# Базовый код
1. Класс Component<T>
Находится в основе практически всех частей проекта, реализует методы для работы с информацией товаров и кнопками.
Конструктор принимает такие аргументы: container: HTMLElement, events: EventEmitter.
Класс имеет такие методы:
-	setText, setImage –– для установки текстов и картинок.
-	toggleClass –– для переключения класса.
-	setDisabled –– для блокировки кнопок.
-	render –– для возврата корневого DOM-элемента.

2. Класс ShopApi
Класс, который облегчает работу с API, а именно запрос товаров с сервера и отправку всех приобретенных товаров и данные покупателя на сервер. 
Класс имеет такие методы:
-	getProducts –– для получения продуктов из сервера.
-	sendOrder –– для отправки товаров и данных о покупке на сервер.

3. Класс EventEmitter
Реализует паттерн «Наблюдатель» и позволяет подписываться на события и уведомлять подписчиков о наступлении события.
Класс имеет методы on,  off,  emit — для подписки на событие, отписки от события и уведомления подписчиков о наступлении события соответственно.
Дополнительно реализованы методы  onAll и  offAll — для подписки на все события и сброса всех подписчиков.
Дополнением является метод  trigger, генерирующий заданное событие с заданными
аргументами. Это позволяет передавать его в качестве обработчика события в другие классы. Эти классы будут генерировать события, не будучи при этом напрямую зависимыми от
класса  EventEmitter.

# Компоненты модели данных
1. Класс ShopModel 
содержит массив объектов, продуктов, которые находятся на странице.
Конструктор принимает такие аргументы: events: IEvents.
Класс имеет такие методы:
-	setProducts –– для обновления карточек.
-	getProducts –– для получения всех карточек.
-	getProduct –– для получения карточки по id.

2. Класс BasketModel
содержит массив объектов, продуктов, которые находятся в корзине.
Конструктор принимает такие аргументы: events: IEvents.
Класс имеет такие методы:
-	addItem, deleteItem –– для добавления и удаления продукта из массива корзины.
- clearItems –– для удаления продуктов из массива корзины.
- getItems –– для получения продуктов находящихся в массиве корзине.
- getItem –– для получения одного продукта из массива корзины по id.
-	getTotalPrice –– для счета общей стоимости продуктов в корзине.

3. Класс OrderModel
Хранит тип оплаты, адрес, email, номер телефона, стоимость товаров, id товаров.
Конструктор принимает такие аргументы: events: IEvents.
Класс имеет такие методы:
- setPaymentType –– проверяет какой тип оплаты выбран и сохраняет это значение.
- setInputValue –– проверяет введен ли корректно адрес, email или номер телефона. Если да, то сохраняет значения полей и эмитит что форма заполнена.
-	validatePaymentForm –– проверяет введены ли корректно данные в форме оплаты, если нет генерирует ошибку и эмитит ее.
- validateContactsForm –– проверяет введены ли корректно данные в форме контактов, если нет генерирует ошибку и эмитит ее.
- setTotalCost –– сохраняет переданную информации о стоимости товаров.
- setItems –– сохраняет id продуктов которые приобретаются.
- setOrder –– записывает все сохраненные данные в объект.
- clearOrder –– сбрасывает все сохраненные данные


# Компоненты представления
1. Класс Header
Хранит кнопку открытия корзины и каунтер.
Конструктор принимает такие аргументы: container: HTMLElement, events: EventEmitter.
Конструктор проверяет наличие контейнера при помощи метода ensureElement и возвращает его как элемент, вещает слушатель на кнопку которая эмитит событие при клике.
Класс имеет такие методы:
-	setTotal –– для вывода количества товаров в корзине в каунтер.

2. Класс Shop 
Находит информацию о контейнере куда необходимо выводить карточки товаров.
Конструктор принимает такие аргументы: container: HTMLElement, events: EventEmitter.
Конструктор проверяет наличие контейнера при помощи метода ensureElement и возвращает его как элемент.
Класс имеет такие методы:
-	setCardList –– для вывода карточек в контейнер

3. Класс Basket
Находит информацию о контейнере куда необходимо выводить продукты, положенные в корзину.
Конструктор принимает такие аргументы: container: HTMLElement, events: EventEmitter.
Конструктор проверяет наличие контейнера и счетчика при помощи метода ensureElement и возвращает его как элемент, вещает слушатель на кнопку которая эмитит события при клике.
Класс имеет такие методы:
-	setItemsList –– для вывода продуктов в контейнер.
- setTotalPrice –– для вывода общей стоимости продуктов в корзине.
- setBasketBtn –– для смены статуса кнопки в зависимости если в корзине есть товар или нет.


4. Класс Card
Способен хранить id продукта. Находит элементы куда необходимо выводить название, изображение, категорию, цену продукта. А также находит кнопку для открытия popup с детальной информацией о продукте.
Конструктор принимает такие аргументы: container: HTMLElement, events: EventEmitter.
Конструктор проверяет наличие элемента при помощи метода ensureElement и возвращает его как элемент, вещает слушатель на кнопку которая эмитит события при клике.
Класс имеет такие методы:
-	title –– для вывода названия продукта.
-	image –– для вывода изображения продукта.
-	category –– для вывода категории продукта.
-	price –– для вывода цену продукта.
- id –– для присвоения карточке id продукта.

5. Класс CardPreview
Способен хранить id продукта. Находит элементы куда необходимо выводить название, описание, изображение, категорию, цену продукта. А также находит кнопку для добавления продукта в корзину.
Конструктор принимает такие аргументы: container: HTMLElement, events: EventEmitter.
Конструктор проверяет наличие элемента при помощи метода ensureElement и возвращает его как элемент, вещает слушатель на кнопку которая эмитит события при клике.
Класс имеет такие методы:
-	title –– для вывода названия продукта.
-	description –– для вывода названия продукта.
-	image –– для вывода изображения продукта.
-	category –– для вывода категории продукта.
-	price –– для вывода цену продукта.
- id –– для присвоения превю id продукта.
- buttonState –– для переключения состояния кнопки.

6. Класс BasketItem
Способен хранить id продукта. Находит элементы куда необходимо выводить название и цену продукта. А также находит кнопку для удаления продукта из корзины.
Конструктор принимает такие аргументы: container: HTMLElement, events: EventEmitter.
Конструктор проверяет наличие элемента при помощи метода ensureElement и возвращает его как элемент, вещает слушатель на кнопку которая эмитит события при клике.
Класс имеет такие методы:
-	title –– для вывода названия продукта.
-	price –– для вывода цену продукта.
- id –– для присвоения id продукта.

7. Класс Payment
Способен хранить id продукта. Находит элемент куда выводить информацию о стоимости покупки, кнопки для выбора способа оплаты, элементы куда необходимо вводить данные. А также находит кнопку для открытия следующего popup.
Конструктор принимает такие аргументы: container: HTMLElement, events: EventEmitter.
Конструктор проверяет наличие элемента при помощи метода ensureElement и возвращает его как элемент, вещает слушатель на кнопки и инпуты которые эмитят события при клике.
Класс имеет такие методы:
- togglePaymentBtns –– для вывода выбранного способа оплаты.
-	validationErrors –– для вывода ошибок при заполнении полей.
- toggleNextBtn –– для активации кнопки если все поля корректно заполнены.
- clearInputs –– для очистки полей ввода.

8. Класс Contacts
Способен хранить id продукта. Находит элемент куда выводить информацию о контактах. А также находит кнопку для открытия следующего popup.
Конструктор принимает такие аргументы: container: HTMLElement, events: EventEmitter.
Конструктор проверяет наличие элемента при помощи метода ensureElement и возвращает его как элемент, вещает слушатель на кнопки и инпуты которые эмитят события при клике.
Класс имеет такие методы:
-	validationErrors –– для вывода ошибок при заполнении полей.
- toggleNextBtn –– для активации кнопки если все поля корректно заполнены.
- clearInputs –– для очистки полей ввода.

9. Класс Success
Способен хранить id продукта. Находит элемент куда выводить информацию о сумме покупки. А также находит кнопку для закоытия popup.
Конструктор принимает такие аргументы: container: HTMLElement, events: EventEmitter.
Конструктор проверяет наличие элемента при помощи метода ensureElement и возвращает его как элемент, вещает слушатель на кнопку которая эмитит событие при клике.
Класс имеет такие методы:
- totalDeduction –– для вывода информации сколько "синапсов" списалось.

10. Класс Modals
Класс Modals позволяет открывать и закрывать popup.
Конструктор принимает такие аргументы: events: EventEmitter.
Его методы:
- openModal –– открывает popup.
- closeModal –– при нажатии на крестик, кнопку Escape или за пределами popup, закрывает popup.

# Ключевые типы данных

interface IProduct {
    title: string;
    description: string;
    image: string;
    category: string;
    price: number;
    id: string;
    buttonState?: boolean;
} // продукт.

export interface IProductList {
    total: number;
    items: IProduct[];
} // продукты с сервера.

interface IShop {
    cardsList: HTMLElement[]; // список карточек на странице.
}

export interface IHeader {
    setCounter: number; // количество товаров в корзине.
}

interface IBasket {
    setItemsList: HTMLElement[]; список товаров отоброжаемых в корзине.
    setTotalPrice: number; стоисость товаров в корзине.
    setBasketBtn: IProduct[]; статус кнопки.
}

interface IPayment {
    validationError: string; // значение ошибки или ошибок.
}

export interface IPaymentErrors {
    paymentError: string; // значение ошибки способа оплаты.
    addressError: string; // значение ошибки адреса.
}

export interface IContacts {
    validationErrors: string; // значение ошибки или ошибок.
}

export interface IContactsErrors {
    emailError: string; // значение ошибки email.
    phoneError: string; // значение ошибки телефона.
}

export interface ISuccess {
    totalDeduction: number; // списание на стоисость товаров в корзине.
}

export interface IOrder extends IOrderData {
	  total: number;
	  items: string[];
} // итоговый заказ с треблваниями всех полей для отправки на сервер.

export interface IOrderData {
    payment: string;
	  address: string;
	  email: string;
	  phone: string;
} // поля данных пользователя

# Ключевые события
items:changed –– событие исходящее, когда поменялось количество предметов в магазине.
modal:openPreview –– событие исходящее при нажатии на карточку товара, которая должна вызвать открытие popup.
basketItems:changed –– событие исходящее, когда поменялось количество предметов в корзине.
modal:openBasket –– событие исходящее при нажатии на кнопку корзины, которая должна вызвать открытие popup.
basket:add –– событие исходящее, когда добавили предмет в корзину.
basket:delete –– событие исходящее, когда удалили предмет в корзине.
modal:openPayment –– событие исходящее при нажатии на кнопку оформить, которая должна вызвать открытие popup.
validate:paymentType –– событие исходящее при нажатии на одну из кнопок для выбора способа оплаты.
validate:address –– событие исходящее при вводе чего-либо в поле ввода адреса.
payment:error –– событие исходящее при ошибке во время заполнения формы оплаты.
payment:ready –– событие исходящее при верном заполнении формы оплаты.
modal:openContacts –– событие исходящее при нажатии на кнопку далее на этапе оплаты, которая должна вызвать открытие popup.
validate:contacts –– событие исходящее при вводе чего либо в поле ввода электронной почты или телефона.
contacts:error –– событие исходящее при ошибке во время заполнения формы контактов.
contacts:ready –– событие исходящее при верном заполнении формы формы контактов.
form:submit –– событие исходящее при отправке формы с оплатой.
modal:close –– событие исходящее при нажатии на кнопку которая должна вызвать закрытие popup.
